\chapter{Implementacja}

Silnik kategoryzacyjny został zaimplementowany w języku C++, z użyciem środowiska Visual Studio w wersji 2010 Express, która jest czasowo ograniczona i bezpłatna do zastosowań niekomercyjnych.

\section{Język C++ i Visual Studio}

Język C++ jest językiem programowania ogólnego przeznaczenia. Jest językiem wieloparadygmatowym, czyli umożliwia stosowanie różnych paradygmatów programowania: proceduralnego, obiektowego i generycznego. Został zaprojektowany przez Bjarne Stroustrupa jako rozszerzenie języka C i użyty po raz pierwszy w 1979 roku. Charakteryzuje się obiektowymi mechanizmami abstrakcji danych oraz silną statyczną kontrolą typów.

Początkowo do realizacji zadania miał zostać wykorzystany język Python, ze względu na bogactwo bibliotek do uczenia maszynowego oraz przetwarzania obrazów. Warto wspomnieć szczególnie o dwóch bibliotekach: scikit-learn oraz scikit-image, które pozwalają na rozwiązanie wielu problemów związanych z klasyfikacją obrazów, klastrowaniem lub ekstrakcją cech. Zdecydowano o użyciu języka C++ z dwóch powodów:

\begin{compactitem}
	\item \emph{szybkość działania} -- kod jest kompilowany do kodu maszynowego, natomiast Python jest językiem interpretowanym i przez to czas potrzebny na osiągnięcie podobnych wyników jest większy,
	\item \emph{silne typowanie} -- w przeciwieństwie do Pythona, język C++ jest silnie typowany, co w ocenie autora niniejszej pracy ma wpływ na zachowanie porządku w kodzie źródłowym.
\end{compactitem}

Microsoft Visual Studio jest zintegrowanym środowiskiem programistycznym rozwijanym przez firmę Microsoft. W skład pakietu wchodzą kompilatory kilku języków: C\#, J\#, Visual Basic, F\#, C++ oraz zintegrowany debugger, który działa na poziomie kodu źródłowego, jak i maszyny. Pierwsze wydanie pakietu pojawiło się w 1995 i obecnie najnowszą wersją jest wersja 12 z 2013 roku. 

Kompilator Visual C++ wchodzący w skład pakietu jest specjalną wersją kompilatora języka C++, dostosowana do systemu Windows. Z tego powodu zawiera wiele dedykowanych bibliotek dla tego systemu operacyjnego, które nie mają swoich odpowiednikach w systemach Linux, Unix lub Mac OS X. Dodatkowo Microsoft wydając ten kompilator stworzył swój własny standard języka, który do wersji Visual Studio 2013 nie był w pełni zgodny z ISO. Co za tym idzie, kod silnika powstały w wersji Visual Studio 2010 nie musi być zgodny z ISO. Na rys. \ref{fig:visual-studio-main-window} przedstawiono widok głównego okna środowiska Visual Studio 2010 Express.

\begin{figure}[h]
	\centering
	\includegraphics[scale=0.4]{graphics/03_implementacja/visual-studio-main-window.pdf}
	\caption{ Główne okno środowiska programistycznego Micsoroft Visual Studio 2010 Express }
	\label{fig:visual-studio-main-window}
\end{figure}

\section{OpenCV}

Do ekstrakcji cech oraz do klasyfikacji wykorzystano OpenCV. Jest to biblioteka do przetwarzania obrazów napisana w języku C, oparta na otwartym kodzie i zapoczątkowana przez firmę Intel. Charakteryzuje się wieloplatformowością, gdyż istnieją wersje na systemy operacyjne Windows, Mac OS X oraz Linux. Umożliwia ponadto, dzięki zastosowaniu odpowiednich nakładek, na tworzenie kodu w różnych językach programowania: C++, C\# oraz Python. Do realizacji zadania wykorzystano OpenCV w wersji 2.2.0.

\section{Architektura systemu}
Zaproponowany system do kategoryzacji obrazów wykorzystuje podejście \emph{Bag of Keypoints}\cite{CSURKA04}. Metoda ta opiera się na kwantyzacji wektorowej deskryptorów i odpowiada histogramowi przypadków występowania poszczególnych wzorców na obrazie. Metoda ta adaptuje podejście \emph{Bag of Words}, które było wcześniej używane do kategoryzacji tekstowej\cite{TONG00}, na potrzeby kategoryzacji obrazów. Do zalet tej metody należy zaliczyć prostotę, wydajność obliczeniową oraz niezależność od przekształceń afinicznych oraz oświetlenia.\cite{CSURKA04} Często metoda ta jest również nazywana metodą \emph{Bag of Words}\cite{TENG11} (tak samo jak w przypadku kategoryzacji tekstu lub \emph{Bag of Visual Words}\cite{KESORN12}.

Na rys. \ref{fig:bag-of-keypoints} przedstawiono mechanizm działania metody \emph{Bag of Keypoints}. Do ekstrakcji punktów charakterystycznych użyto algorytmów SIFT oraz SURF, w celu określenia który z nich daje lepsze wyniki dla kategoryzacji zbioru testowego. Punkty charakterystyczne znalezione na różnych obrazach są następnie klastrowane w celu znalezienia zbioru podobnych do siebie fragmentów obrazów. W celu określenia, które fragmenty są do siebie podobne użyto biblioteki FLANN (\emph{Fast Approximate Nearest Neighbor Search}). Powstałe w ten sposób klastry często określa się jako słowa wizualne (\emph{ang. visual words}).

Następnie jako deskryptor obrazu używane są histogramy częstości występowania poszczególnych słów wizualnych. Jako klasyfikator została użyta maszyna wektorów nośnych (SVM).

\begin{figure}[h]
	\centering
	\includegraphics[scale=1.0]{graphics/03_implementacja/bag-of-keypoints.pdf}
	\caption{ Schemat działania metody \emph{Bag of Keypoints} }
	\label{fig:bag-of-keypoints}
\end{figure}

Projekt składa się z następujących klas:
\begin{compactitem}
	\item \emph{ImageCategorization} -- odpowiada za ekstrakcję cech oraz proces kategoryzacji, 
	\item \emph{ImageCategorizationAPI} -- udostępnia publiczne API pozwalające na tworzenie modelu kategoryzacyjnego, uczenie na podstawie przygotowanych zestawów przykładów, określanie kategorii wybranego obrazu,
	\item \emph{ImageCategorizationTest} -- umożliwia przeprowadzenie testowania skuteczności procesu kategoryzacji na podstawie przykładowych zestawów uczących i testowych.
\end{compactitem}

\section{Konfiguracja środowiska}
Aby uruchomić program w środowisku Windows, należy w pierwszej kolejności zainstalować Microsoft Visual Studio 2010 Express oraz OpenCV w wersji 2.2.0.


\section{Opis API}
...